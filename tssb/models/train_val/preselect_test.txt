RETAIN YEARS <YEAR_START> THROUGH <TEST_YEAR> ;
RETAIN MARKET LIST "..\..\ALL_SYMBOLS.TXT" ;
READ DATABASE "<DB_NAME>.DAT" "<DB_NAME>.FAM" ;

APPEND DATABASE "<TRADE_DB>" ;

REALPROFIT IS PROFIT ;

OUTLIER SCAN ;

MODEL FILTLONG1 IS <MODEL> [
   INPUT = [ <GROUP1> ]
   OUTPUT = REALPROFIT
   MAX STEPWISE = 0
   STEPWISE RETENTION = <RETENTION>
   CRITERION = LONG PROFIT FACTOR
   MIN CRITERION FRACTION = <MIN_CRIT>
   SHOW SELECTION COUNT
] ;

MODEL FILTLONG2 IS <MODEL> [
   INPUT = [ <GROUP2> ]
   OUTPUT = REALPROFIT
   MAX STEPWISE = 0
   STEPWISE RETENTION = <RETENTION>
   CRITERION = LONG PROFIT FACTOR
   MIN CRITERION FRACTION = <MIN_CRIT>
   SHOW SELECTION COUNT
] ;

MODEL FILTLONG3 IS <MODEL> [
   INPUT = [ <GROUP3> ]
   OUTPUT = REALPROFIT
   MAX STEPWISE = 0
   STEPWISE RETENTION = <RETENTION>
   CRITERION = LONG PROFIT FACTOR
   MIN CRITERION FRACTION = <MIN_CRIT>
   SHOW SELECTION COUNT
] ;


COMMITTEE COMM2 IS CONSTRAINED [
   INPUT = [ FILTLONG1 FILTLONG2 FILTLONG3 ]
   OUTPUT = REALPROFIT
   MAX STEPWISE = 0
   CRITERION = LONG PROFIT FACTOR
   MIN CRITERION FRACTION = <MIN_CRIT>
   MCP TEST = 1000
] ;

COMMITTEE COMM3 IS CONSTRAINED [
   INPUT = [ FILTLONG1 FILTLONG2 FILTLONG3 ]
   OUTPUT = REALPROFIT
   MAX STEPWISE = 3
   CRITERION = LONG PROFIT FACTOR
   MIN CRITERION FRACTION = <MIN_CRIT>
   MCP TEST = 1000
] ;

COMMITTEE COMM5 IS AVERAGE [
   INPUT = [ FILTLONG1 FILTLONG2 FILTLONG3 ]
   OUTPUT = REALPROFIT
   MAX STEPWISE = 0
   CRITERION = LONG PROFIT FACTOR
   MIN CRITERION FRACTION = <MIN_CRIT>
   MCP TEST = 1000
] ;

COMMITTEE COMM6 IS AVERAGE [
   INPUT = [ FILTLONG1 FILTLONG2 FILTLONG3 ]
   OUTPUT = REALPROFIT
   MAX STEPWISE = 3
   CRITERION = LONG PROFIT FACTOR
   MIN CRITERION FRACTION = <MIN_CRIT>
   MCP TEST = 1000
] ;

WALK FORWARD BY year 10 <TEST_YEAR> ;
